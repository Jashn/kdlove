var Mailcheck={domainThreshold:4,topLevelThreshold:3,defaultDomains:["yahoo.com","google.com","hotmail.com","gmail.com","me.com","aol.com","mac.com","live.com","comcast.net","googlemail.com","msn.com","hotmail.co.uk","yahoo.co.uk","facebook.com","verizon.net","sbcglobal.net","att.net","gmx.com","mail.com","outlook.com","icloud.com"],defaultTopLevelDomains:["co.jp","co.uk","com","net","org","info","edu","gov","mil","ca"],run:function(opts){opts.domains=opts.domains||Mailcheck.defaultDomains;opts.topLevelDomains=opts.topLevelDomains||Mailcheck.defaultTopLevelDomains;opts.distanceFunction=opts.distanceFunction||Mailcheck.sift3Distance;var defaultCallback=function(result){return result};var suggestedCallback=opts.suggested||defaultCallback;var emptyCallback=opts.empty||defaultCallback;var result=Mailcheck.suggest(Mailcheck.encodeEmail(opts.email),opts.domains,opts.topLevelDomains,opts.distanceFunction);return result?suggestedCallback(result):emptyCallback()},suggest:function(email,domains,topLevelDomains,distanceFunction){email=email.toLowerCase();var emailParts=this.splitEmail(email);var closestDomain=this.findClosestDomain(emailParts.domain,domains,distanceFunction,this.domainThreshold);if(closestDomain){if(closestDomain!=emailParts.domain){return{address:emailParts.address,domain:closestDomain,full:emailParts.address+"@"+closestDomain}}}else{var closestTopLevelDomain=this.findClosestDomain(emailParts.topLevelDomain,topLevelDomains,distanceFunction,this.topLevelThreshold);if(emailParts.domain&&closestTopLevelDomain&&closestTopLevelDomain!=emailParts.topLevelDomain){var domain=emailParts.domain;closestDomain=domain.substring(0,domain.lastIndexOf(emailParts.topLevelDomain))+closestTopLevelDomain;return{address:emailParts.address,domain:closestDomain,full:emailParts.address+"@"+closestDomain}}}
return !1},findClosestDomain:function(domain,domains,distanceFunction,threshold){threshold=threshold||this.topLevelThreshold;var dist;var minDist=99;var closestDomain=null;if(!domain||!domains){return !1}
if(!distanceFunction){distanceFunction=this.sift3Distance}
for(var i=0;i<domains.length;i++){if(domain===domains[i]){return domain}
dist=distanceFunction(domain,domains[i]);if(dist<minDist){minDist=dist;closestDomain=domains[i]}}
if(minDist<=threshold&&closestDomain!==null){return closestDomain}else{return !1}},sift3Distance:function(s1,s2){if(s1==null||s1.length===0){if(s2==null||s2.length===0){return 0}else{return s2.length}}
if(s2==null||s2.length===0){return s1.length}
var c=0;var offset1=0;var offset2=0;var lcs=0;var maxOffset=5;while((c+offset1<s1.length)&&(c+offset2<s2.length)){if(s1.charAt(c+offset1)==s2.charAt(c+offset2)){lcs++}else{offset1=0;offset2=0;for(var i=0;i<maxOffset;i++){if((c+i<s1.length)&&(s1.charAt(c+i)==s2.charAt(c))){offset1=i;break}
if((c+i<s2.length)&&(s1.charAt(c)==s2.charAt(c+i))){offset2=i;break}}}
c++}
return(s1.length+s2.length)/2-lcs},splitEmail:function(email){var parts=email.trim().split('@');if(parts.length<2){return !1}
for(var i=0;i<parts.length;i++){if(parts[i]===''){return !1}}
var domain=parts.pop();var domainParts=domain.split('.');var tld='';if(domainParts.length==0){return !1}else if(domainParts.length==1){tld=domainParts[0]}else{for(var i=1;i<domainParts.length;i++){tld+=domainParts[i]+'.'}
if(domainParts.length>=2){tld=tld.substring(0,tld.length-1)}}
return{topLevelDomain:tld,domain:domain,address:parts.join('@')}},encodeEmail:function(email){var result=encodeURI(email);result=result.replace('%20',' ').replace('%25','%').replace('%5E','^').replace('%60','`').replace('%7B','{').replace('%7C','|').replace('%7D','}');return result}};if(typeof module!=='undefined'&&module.exports){module.exports=Mailcheck}
if(typeof window!=='undefined'&&window.jQuery){(function($){$.fn.mailcheck=function(opts){var self=this;if(opts.suggested){var oldSuggested=opts.suggested;opts.suggested=function(result){oldSuggested(self,result)}}
if(opts.empty){var oldEmpty=opts.empty;opts.empty=function(){oldEmpty.call(null,self)}}
opts.email=this.val();Mailcheck.run(opts)}})(jQuery)};zk.mailcheck||(function(){zk.mailcheck=function(input,$form){var sVars=ZK.mailcheck;var $input=input instanceof jQuery?input:$('#'+input,$form);if(!$input.length){return}
var $clue=$('<span class="f-r info" style="display: none;"></span>');$clue.insertAfter($input);var $info=$clue.siblings('.info');var config={domains:['163.com','alice.it','aliceadsl.fr','aol.com','aol.es','aon.at','arcor.de','att.net','bbox.fr','bellsouth.net','bluemail.ch','bluewin.ch','blueyonder.co.uk','bol.com.br','btinternet.com','cegetel.net','chello.at','clix.pt','club-internet.fr','comcast.net','COX.NET','dbmail.com','email.com','email.it','fastwebnet.it','free.fr','freenet.de','ge.com','globo.com','globomail.com','gmail.com','gmail.com.br','gmail.es','gmx.com','gmx.de','gmx.net','googlemail.com','hispeed.ch','homail.com','hotmail.co.uk','hotmail.com','hotmail.com.ar','hotmail.es','hotmail.fr','hotmail.it','hotmal.com','hp.com','ibest.com.br','ig.com.br','interfree.it','interia.eu','interia.pl','inwind.it','iol.it','katamail.com','laposte.net','libero.it','libertysurf.fr','limao.com.br','live.co.uk','live.com','live.com.ar','live.fr','mac.com','mail.com','mail.es','mailinator.com','me.com','msn.com','netcabo.pt','netcourrier.com','neuf.fr','noos.fr','ntlworld.com','numericable.fr','o2.pl','oi.com.br','onet.eu','onet.pl','online.fr','ono.com','op.pl','orange.fr','pop.com.br','portugalmail.pt','poste.it','qq.com','r7.com','rocketmail.com','sapo.pt','sbcglobal.net','secuoyas.com','sfr.fr','sky.com','skynet.be','sunrise.ch','talk21.com','tele2.it','telefonica.net','telenet.be','teletu.it','terra.com.br','terra.es','tin.it','tiscali.it','tlen.pl','t-online.de','uol.com.br','verizon.net','videotron.ca','virgilio.it','vodafone.it','voila.fr','vp.pl','wanadoo.es','wanadoo.fr','web.de','wp.pl','wp.pl','yahoo.co.uk','yahoo.com','yahoo.com.br','yahoo.es','ymail.com','yopmail.com','zipmail.com.br'],topLevelDomains:["com","net","org","info","edu","gov","mil","co.uk","es","pl","nl","it","fr","de","pt","mx","br","ch","at","ie","ve","ec","pe","ar","co","cl","at","be"]};var _suggest=function(suggestion){var link='<a href="#" class="suggestion custom-link">'+suggestion.address+'&#64;'+suggestion.domain+'</a>';var msg=sVars.translate.did_you_mean.replace('%s',link);$clue.html(msg).fadeIn(200);$info.hide()};$input.blur(function(){$clue.hide().empty();$(this).mailcheck({domains:config.domains,topLevelDomains:config.topLevelDomains,suggested:function(element,suggestion){_suggest(suggestion)}})});$clue.click(function(){$input.val($(this).find('.suggestion').text());$input.blur();$(this).fadeOut(200,function(){$(this).empty();$info.fadeIn(100)});return !1});return{suggest:_suggest}}})();zk.onDocumentReady(['form','decorator','mailcheck'],function(sVars){function _getFields(){var fields=[];$.each(sVars,function(key,value){if(key.substr(0,6)==='field_'){fields.push(value)}});return fields}
$.each(_getFields(),function(key,field){zk.mailcheck(field.id)})})